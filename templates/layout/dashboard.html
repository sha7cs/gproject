{% extends "base.html" %}
{% load static %}
{% block title%} Home {% endblock %}

{% block content %}
<style>
  .card {
    border-radius: 20px; }
</style>
<main role="main" class="main-content">
  <div class="container-fluid">
    <h1>Welcome, {{ username }}!</h1>
    <div class="row my-4">
      <!-- Tall Card on the left -->
      <div class="col-md-6">
        <div class="card shadow mb-4 h-100">
          <div class="card-body">
            <h5 class="card-title">Main Overview</h5>
            <canvas id="categoryPieChart"></canvas>
            <a href="{% url 'analysis' %}">Go to Analysis</a>
            <p class="card-text"></p>
          </div>
        </div>
      </div>
    
      <!-- Two stacked cards on the right -->
      <div class="col-md-6 d-flex flex-column">
        <!-- Top right card -->
        <div class="card shadow mb-3 flex-fill">
          <div class="card-body">
            <h6 class="card-title">Top Right</h6>
            <h4 class="title mb-3">{{ advice_title }}</h4>
            <a href="{% url 'promotions' %}">Go to Promotions</a>
            <p class="card-text"></p>
          </div>
        </div>
        <!-- Bottom right card -->
        <div class="card shadow flex-fill">
          <div class="card-body">
            <h6 class="card-title">Bottom Right</h6>
            <h4 class="title mb-0" >{{ next_event.event_name }}</h4>
            <a href="{% url 'promotions' %}">Go to Promotions</a>
            <p class="card-text"></p>
          </div>
        </div>
      </div>
    </div>

  </div>
</main> <!-- main -->

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
  const ctx = document.getElementById('categoryPieChart').getContext('2d');
  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: {{ category_labels|safe }},
      datasets: [{
        label: 'Category Sales',
        data: {{ category_data|safe }},
        backgroundColor: [
                            '#D5F2FE', '#A4DADE', '#E3E2F6','#C5C4E0', '#E3E7CF',  '#B9BDAC','#71AFB4', '#602E9E', '#8F9474'  
                        ],
      }]
    },
    options: {
      responsive: true,
      plugins: {
        legend: { position: 'bottom' }
      }
    }
  });
});
</script>

{% endblock content %}